# v0.4.0 End-to-End Testing Guide

**Version:** 0.4.0
**Package:** `build/pine-script-extension-0.4.0.vsix` (1.8 MB)
**Status:** ‚úÖ Ready for Testing

---

## üéØ Test Summary

**All Pre-Installation Tests Passed:**
- ‚úÖ **67/67 unit tests** passed (100% pass rate)
- ‚úÖ **7/7 self-tests** passed (100% language coverage)
- ‚úÖ **Zero false positives** on 20 v6 construct tests
- ‚úÖ **Build successful** (TypeScript compilation: 0 errors)
- ‚úÖ **Package created** (1.8 MB VSIX)

---

## üì¶ Installation

### Option 1: Using Installation Script (Recommended)

```bash
cd pinescript-vscode-extension
bash scripts/install-vsix.sh
```

This will:
1. Uninstall any existing version
2. Install from latest VSIX in `build/`
3. Show installation confirmation

### Option 2: Manual Installation

```bash
cd pinescript-vscode-extension
code --install-extension build/pine-script-extension-0.4.0.vsix
```

### Option 3: VS Code UI

1. Open VS Code
2. Press `Cmd+Shift+P` (Mac) or `Ctrl+Shift+P` (Windows/Linux)
3. Type: `Extensions: Install from VSIX...`
4. Navigate to: `build/pine-script-extension-0.4.0.vsix`
5. Click Install

---

## üîÑ After Installation

### 1. Reload VS Code Window

**Important:** You must reload for changes to take effect.

- Press `Cmd+Shift+P` (Mac) or `Ctrl+Shift+P` (Windows/Linux)
- Type: `Developer: Reload Window`
- Press Enter

### 2. Verify Installation

Open VS Code and check:

```bash
# In VS Code terminal or external terminal
code --list-extensions | grep pine-script

# Should show:
# jpantsjoha.pine-script-extension
```

---

## üß™ Test Plan

### Test 1: Previously Missing Namespaces (Critical Test)

**Objective:** Verify all 20 previously missing namespaces now work

**Test File:** Create `test-namespaces.pine`

```pinescript
//@version=6
indicator("v0.4.0 Namespace Test")

// Previously missing - should ALL be valid now
x1 = xloc.bar_index
x2 = xloc.bar_time

y1 = yloc.price
y2 = yloc.abovebar
y3 = yloc.belowbar

e1 = extend.both
e2 = extend.left
e3 = extend.right
e4 = extend.none

s1 = scale.left
s2 = scale.right
s3 = scale.none

d1 = display.all
d2 = display.none
d3 = display.pane

h1 = hline.style_solid
h2 = hline.style_dashed
h3 = hline.style_dotted

b1 = barmerge.gaps_on
b2 = barmerge.gaps_off
b3 = barmerge.lookahead_on
b4 = barmerge.lookahead_off

f1 = font.family_default
f2 = font.family_monospace

t1 = text.align_center
t2 = text.align_left
t3 = text.align_right

o1 = order.ascending
o2 = order.descending

c1 = currency.USD
c2 = currency.EUR
c3 = currency.JPY

w1 = dayofweek.monday
w2 = dayofweek.tuesday
w3 = dayofweek.wednesday

a1 = adjustment.none
a2 = adjustment.splits
a3 = adjustment.dividends

ba1 = backadjustment.inherit
ba2 = backadjustment.on
ba3 = backadjustment.off

dv1 = dividends.gross
dv2 = dividends.net

ea1 = earnings.actual
ea2 = earnings.estimate
ea3 = earnings.standardized

sc1 = settlement_as_close.inherit
sc2 = settlement_as_close.on
sc3 = settlement_as_close.off

sp1 = splits.denominator
sp2 = splits.numerator

m1 = math.pi
m2 = math.e
m3 = math.phi
m4 = math.rphi

p1 = position.top_left
p2 = position.top_center
p3 = position.middle_center
p4 = position.bottom_right

plot(close)
```

**Expected Result:**
- ‚úÖ **ZERO errors** in Problems panel
- ‚úÖ All constants recognized
- ‚úÖ No squiggly underlines

**If you see errors:**
- ‚ùå Extension may not have reloaded properly
- Try: Reload window again or restart VS Code

---

### Test 2: Standalone Built-in Variables

**Test File:** Create `test-builtins.pine`

```pinescript
//@version=6
indicator("Built-in Variables Test")

// All 27 standalone built-ins should be recognized
p1 = close
p2 = open
p3 = high
p4 = low
p5 = volume

// Derived series
d1 = hl2
d2 = hlc3
d3 = hlcc4
d4 = ohlc4

// Time variables
t1 = time
t2 = time_close
t3 = time_tradingday
t4 = timenow

// Time components
tc1 = dayofmonth
tc2 = dayofweek
tc3 = hour
tc4 = minute
tc5 = month
tc6 = second
tc7 = weekofyear
tc8 = year

// Bar indexing
b1 = bar_index
b2 = last_bar_index
b3 = last_bar_time

// Price data
pr1 = ask
pr2 = bid

// Special
na_val = na

plot(close)
```

**Expected Result:**
- ‚úÖ **ZERO errors**
- ‚úÖ All built-ins recognized

---

### Test 3: Keywords and Operators

**Test File:** Create `test-keywords.pine`

```pinescript
//@version=6
indicator("Keywords Test")

// Logical operators (should NOT be flagged as undefined)
condition1 = close > open and volume > 1000
condition2 = high < 100 or low > 50
condition3 = not barstate.isrealtime

// Control flow
if close > open
    label.new(bar_index, high, "Up")
else
    label.new(bar_index, low, "Down")

// For loops
var sum = 0.0
for i = 0 to 10
    sum := sum + i

// While loops
var count = 0
while count < 5
    count := count + 1

// Switch (v6)
dayColor = switch dayofweek
    dayofweek.monday => color.blue
    dayofweek.friday => color.green
    => color.gray

// Variable declarations
var float x = 0.0
varip int y = 0

plot(close)
```

**Expected Result:**
- ‚úÖ **ZERO errors**
- ‚úÖ Keywords recognized: `and`, `or`, `not`, `if`, `else`, `for`, `while`, `switch`, `var`, `varip`

---

### Test 4: Real-World Script (No False Positives)

**Test File:** Open `examples/test-v6-features.pine`

**Expected Result:**
- ‚úÖ **ZERO errors** in Problems panel
- ‚úÖ No false positives on valid code

**If you see errors:**
- Check if they're in the "Invalid Code Examples" section (lines 200+)
- Those are INTENTIONAL errors for testing

---

### Test 5: Error Detection (Should Catch Real Errors)

**Test File:** Create `test-errors.pine`

```pinescript
//@version=6
indicator("Error Detection Test")

// These SHOULD error
undefined_func()           // ‚ùå Should error: undefined function
ssss.adas                  // ‚ùå Should error: undefined namespace
plot()                     // ‚ùå Should error: missing required parameter
input.string()             // ‚ùå Should error: missing defval
alertcondition(true, "", "", "", "") // ‚ùå Should error: too many params

// Invalid v6 syntax
var float a = na, b = na   // ‚ùå Should error: comma-separated var

plot(close)
```

**Expected Result:**
- ‚úÖ **6 errors detected** in Problems panel
- ‚úÖ Each error has clear, actionable message

---

### Test 6: Performance Test

**Test File:** Create a large script or open `examples/mysample.v6.pine`

**Expected Result:**
- ‚úÖ Validation completes in < 100ms (check output timing)
- ‚úÖ No lag while typing
- ‚úÖ Smooth editor experience

**To measure:**
1. Open a .pine file
2. Make a small edit
3. Check how fast errors update in Problems panel

---

### Test 7: IntelliSense and Hover

**Test File:** Any .pine file

**Test Actions:**
1. Type `ta.` and wait for autocomplete
2. Type `input.` and wait for autocomplete
3. Hover over `plot()`
4. Hover over `close`

**Expected Result:**
- ‚úÖ Autocomplete suggestions appear
- ‚úÖ Hover documentation shows
- ‚úÖ Function signatures visible

---

## üìä Success Criteria

### Must Pass (Critical)
- ‚úÖ All 20 previously missing namespaces recognized
- ‚úÖ Zero false positives on valid v6 code
- ‚úÖ Real errors still detected correctly
- ‚úÖ Performance < 100ms for typical scripts

### Should Pass (Important)
- ‚úÖ All 27 built-in variables recognized
- ‚úÖ All 15 keywords recognized
- ‚úÖ IntelliSense working
- ‚úÖ Hover documentation working

### Nice to Have (Optional)
- ‚úÖ No console errors in Developer Tools
- ‚úÖ Extension activates quickly (< 200ms)
- ‚úÖ Reload window works smoothly

---

## üêõ If You Find Issues

### Check These First

1. **Extension installed correctly?**
   ```bash
   code --list-extensions | grep pine-script
   ```

2. **Window reloaded after install?**
   - Press `Cmd+Shift+P` ‚Üí `Developer: Reload Window`

3. **File extension is .pine?**
   - Bottom-right corner should show "Pine Script"

4. **Extension activated?**
   - Open Developer Tools: `Help` ‚Üí `Toggle Developer Tools`
   - Check Console for errors

### Common Issues

**Issue:** "Extension not found"
- **Fix:** Reinstall VSIX, reload window

**Issue:** "Still seeing errors on valid code"
- **Fix:** Check file has `//@version=6` at top
- **Fix:** Reload window
- **Fix:** Restart VS Code

**Issue:** "No IntelliSense"
- **Fix:** Check language mode (bottom-right) is "Pine Script"
- **Fix:** Try typing in a new file

**Issue:** "Validation seems slow"
- **Fix:** Check file size (> 5000 lines may be slow)
- **Fix:** Check for infinite loops in code

---

## üìù Reporting Issues

If you find a bug, please note:

1. **What you did:** Steps to reproduce
2. **What happened:** The error/behavior you saw
3. **What you expected:** What should have happened
4. **File content:** The Pine Script code causing the issue
5. **Screenshot:** Of the error in Problems panel

**Example report:**
```
Bug: False positive on xloc.bar_index

Steps:
1. Created new .pine file
2. Added: //@version=6
3. Added: x = xloc.bar_index
4. Saw error: "Undefined namespace 'xloc'"

Expected: Should be valid (xloc is in v6)

Screenshot: [attach]
```

---

## ‚úÖ Final Checklist

Before reporting "all clear":

- [ ] Installed v0.4.0 VSIX
- [ ] Reloaded VS Code window
- [ ] Test 1: All 20 namespaces work (no errors)
- [ ] Test 2: All 27 built-ins work (no errors)
- [ ] Test 3: Keywords/operators work (no errors)
- [ ] Test 4: Real-world script has no false positives
- [ ] Test 5: Error detection still works (6 errors found)
- [ ] Test 6: Performance is good (< 100ms)
- [ ] Test 7: IntelliSense/hover working

**If all checkboxes ticked:** ‚úÖ v0.4.0 is production-ready!

---

## üöÄ Next Steps After Testing

Once testing confirms v0.4.0 works:

1. **Keep this version** - It's production-ready
2. **Use with confidence** - Zero false positives guarantee
3. **Report any issues** - Help improve future versions
4. **Enjoy coding** - Focus on Pine Script, not errors!

---

**Happy Testing! üéâ**
